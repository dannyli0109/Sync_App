<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sync Watch</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <h1>Sync Watch</h1>
      <p>Share a room link, upload a video, and watch together in sync.</p>
    </header>

    <main class="app-main">
      <section class="room-controls">
        <div class="room-form">
          <label for="displayName">Display name</label>
          <input type="text" id="displayName" maxlength="24" placeholder="Guest" />
        </div>
        <div class="room-form join">
          <label for="roomIdInput">Join existing room</label>
          <div class="inline">
            <input type="text" id="roomIdInput" placeholder="Enter room ID" />
            <button id="joinRoomButton">Join</button>
          </div>
        </div>
        <div class="room-form create">
          <span class="label">Need a room?</span>
          <button id="createRoomButton">Create room</button>
        </div>
      </section>

      <section class="room-info" id="roomInfo" hidden>
        <div>
          <strong>Room:</strong> <span id="roomIdLabel"></span>
        </div>
        <div>
          <strong>Your role:</strong> <span id="roleLabel">Viewer</span>
          <button id="takeHostButton">Take control</button>
        </div>
        <div>
          <strong>Share link:</strong>
          <span id="shareLink"></span>
          <button id="copyLinkButton">Copy</button>
        </div>
      </section>

      <section class="video-controls" id="videoControls" hidden>
        <label for="videoFileInput">Upload video (mp4, webm, mov...)</label>
        <div class="inline file-input">
          <input type="file" id="videoFileInput" accept="video/*" />
          <button id="uploadVideoButton">Upload &amp; Share</button>
        </div>
        <div class="upload-progress" id="uploadProgress" hidden>
          <div class="progress-bar">
            <div class="progress-bar-fill" id="uploadProgressFill"></div>
          </div>
          <span class="progress-label" id="uploadProgressLabel">0%</span>
        </div>
        <div class="link-controls">
          <label for="externalUrlInput">Share a video link</label>
          <div class="inline url-input">
            <input
              type="url"
              id="externalUrlInput"
              placeholder="https://example.com/video.mp4"
              autocomplete="off"
            />
            <input
              type="text"
              id="externalNameInput"
              placeholder="Optional name"
              autocomplete="off"
              maxlength="180"
            />
            <button type="button" id="addExternalVideoButton">Add Link</button>
          </div>
          <p class="hint small">
            Paste a direct http(s) video URL. Works best with MP4, HLS (m3u8), or other streaming
            links that allow anonymous playback.
          </p>
        </div>
        <p class="hint" id="videoStatus" data-state="info">No video loaded yet.</p>
        <p class="hint" id="hostHint">Only the host can upload and control playback.</p>
      </section>

      <section class="video-library" id="videoLibrary" hidden>
        <div class="video-library-header">
          <h2>Video Library</h2>
          <button id="refreshLibraryButton" type="button">Refresh</button>
        </div>
        <p class="hint" id="libraryStatus" data-state="info">Loading videos...</p>
        <ul class="video-list" id="videoList"></ul>
      </section>

      <section class="player-section">
        <div id="playerContainer" class="player-container">
          <div class="player-placeholder">
            <p>Select or create a room, then upload a video to get started.</p>
          </div>
        </div>
      </section>
    </main>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/app.js" type="module"></script>
  </body>
</html>
